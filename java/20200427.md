# JVM 아키텍처

외워도 외워도 까먹는 JVM 아키텍처!



```textile
┌───────────────────────────────────────────────┐
│   ┌───────────────────────┐                   │
│   │  Class Loader System  │                   │
│   └───────────────────────┘                   │
│                                               │
│                                               │
│                                               │
│  ┌─────────┐   ┌────────┐    ┌──────────────┐ │
│  │ loading │   │linking │    │initialization│ │
│  └─────────┘   └────────┘    └──────────────┘ │
│                                               │
└───────────────────────────────────────────────┘
                         │
                         └──────┐
                                ▼
┌───────────────────────────────────────────────────────────────┐
│  ┌───────────────────┐                                        │
│  │      Memory       │                                        │
│  └───────────────────┘                                        │
│                                                               │
│                                                               │
│                                                               │
│ ┌──────┐ ┌───────────────┐┌──────────────────────┐┌────┐┌────┐│
│ │stack │ │ PC registers  ││ Native method stack  ││heap││meth││
│ └──────┘ └───────────────┘└──────────────────────┘└────┘└────┘│
│                                                               │
│                                                               │
└───────────────────────────────────────────────────────────────┘
                                │
                                │
              ┌─────────────────┴──────┐
              │                        │
              ▼                        │
┌──────────────────────────┐           ▼
│ ┌─────────────────────┐  │    ┌────────────┐
│ │  Execution Engine   │  │    │            │    ┌───────────┐
│ │                     │  │    │   Native   │    │  Native   │
│ └─────────────────────┘  │ ┌──│   Method   │─┐  │  Method   │
│                          │ │  │ Interface  │ └──│  Library  │
│┌───────────┐ ┌────┐┌────┐│─┘  │            │    │           │
││interpreter│ │JIT ││ GC ││    └────────────┘    └───────────┘
│└───────────┘ └────┘└────┘│
│                          │
│                          │
└──────────────────────────┘
```



- 로딩: 클래스를 읽어오는 과정

- 링크: 레퍼런스를 연결

- 초기화: static 값에 대한 초기화

- 스택: 쓰레드마다 런타입 스택을 만들고, 그 안에 메소드 호출을 스택프레임이라 부르는 블럭으로 쌓는다.

- PC: 쓰레드마다 실행할 스택 프레임을 가리키는 포인터 생성

- 네이티브메소드스택: 

- 힙: 객체를 저장

- 메소드: 클래스 수준의 정보(클래스 이름, 부모클래스 이름, 메소드, 변수) 저장.

- 인터피리터: 바이트코드를 한줄씩 실행

- JIT: 인터프리터가 반복되는 코드를 발견하면 그것을 네이티브 코드로 바꾼다. 그 이후 인터프리터는 네이티브 코드로 컴파일된 코드를 사용한다.

- GC: 객체 정리

- JNI: C, C++, 어셈블리로 작성한 코드 사용

- 네이티브 메소드 라이브러리: C, C++로 작성된 라이브러리.


